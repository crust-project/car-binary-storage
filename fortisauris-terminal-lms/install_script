import os
import sys
import subprocess

def deps():
    exitcode = os.system("pip3 --version")
    if exitcode != 0:
        print("Pip is not installed. Pip comes pre-installed with Redrose, if you deleted it, please reinstall it.")

    exitcode = os.system("git --version")
    if exitcode != 0:
        print("Git is not installed. Git comes pre-installed with Redrose, if you deleted it, please reinstall it.")

def build():
    os.system("git clone https://github.com/andrejli/my-first-blog.git")
    os.chdir("my-first-blog")

    # Create virtual environment
    os.system(f"{sys.executable} -m venv venv")

    # Paths to venv python/pip
    venv_python = os.path.join("venv", "bin", "python")
    venv_pip = os.path.join("venv", "bin", "pip")

    # Install dependencies in venv
    subprocess.run([venv_pip, "install", "-r", "requirements.txt"], check=True)

    # Run Django commands using venv Python
    subprocess.run([venv_python, "manage.py", "migrate"], check=True)
    subprocess.run([venv_python, "manage.py", "runserver"], check=True)

def install():pass

def postinst():
    print("Server stopped")
